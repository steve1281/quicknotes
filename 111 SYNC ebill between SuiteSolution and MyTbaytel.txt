SELECT  ca.billpointid ,
        ca.isSubscribed ,
        bp.blp_pull_code
FROM    tbt.CustomerAccount ca
        JOIN OPENQUERY(suitesolutions,
                       'select blp_billing_point_id, blp_pull_code from billing_point') bp ON ca.BillPointID = bp.blp_billing_point_id
WHERE   ca.IsActive = 1
        AND ( ( bp.blp_pull_code IN ( 'EN', 'EO' ) --customer gets no paper bill, and no eBill notification
                AND ca.issubscribed = 0
              )
              OR ( bp.blp_pull_code IS NULL --customer gets paper bill, and also gets eBill notification
                   AND ca.issubscribed = 1
                 )
            )