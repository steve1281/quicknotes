declare @in1 as table (
id varchar(5),
x integer
)

declare @in2 as table (
 id varchar(5),
 x1 integer,
 x2 integer,
 x3 integer,
 x4 integer,
 x5 integer
)

insert into @in1 values(1,1)
insert into @in1 values(1,3)
insert into @in1 values(1,4)
insert into @in1 values(1,5)
insert into @in1 values(2,1)
insert into @in1 values(2,3)
insert into @in1 values(3,4)
insert into @in1 values(3,1)


select * from @in1

insert into @in2 
select 
   id
    , case when x = 1 then 1 else 0 end x1
    , case when x = 2 then 1 else 0 end x2
    , case when x = 3 then 1 else 0 end x3
    , case when x = 4 then 1 else 0 end x4
    , case when x = 5 then 1 else 0 end x5
from @in1 

select 
   id,
   max(x1) as x1,
   max(x2) as x2,
   max(x3) as x3,
   max(x4) as x4,
   max(x5) as x5

from @in2
group by id 
